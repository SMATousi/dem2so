cuda
Data is loaded
  0%|                                                                                                                    | 0/582 [00:01<?, ?it/s]
  0%|                                                                                                                     | 0/64 [00:00<?, ?it/s]
  0%|                                                                                                                    | 0/582 [00:00<?, ?it/s]
Epoch [1/100] - Loss: 2.2674686908721924
{'Train/accuracy': 0.0583038330078125, 'Train/iou': 0.1111111111111111, 'Train/dice': -0.00023117105027092855}
{'Validation/accuracy': 0.5618743896484375, 'Validation/iou': 0.1111111111111111, 'Validation/dice': 0.2850215895658594}
Epoch [2/100] - Loss: 2.245701313018799
{'Train/accuracy': 0.117889404296875, 'Train/iou': 0.1111111111111111, 'Train/dice': -3.9385615527311666}
{'Validation/accuracy': 0.5618743896484375, 'Validation/iou': 0.1111111111111111, 'Validation/dice': 0.4342429825913379}
Epoch [3/100] - Loss: 2.1937451362609863
{'Train/accuracy': 0.210662841796875, 'Train/iou': 0.1111111111111111, 'Train/dice': 8.070244502205945}
{'Validation/accuracy': 0.5447540283203125, 'Validation/iou': 0.1111111111111111, 'Validation/dice': 0.544054325603122}
Epoch [4/100] - Loss: 2.1812238693237305
{'Train/accuracy': 0.217620849609375, 'Train/iou': 0.1111111111111111, 'Train/dice': 2.7683229017616675}
{'Validation/accuracy': 0.4805450439453125, 'Validation/iou': 0.1111111111111111, 'Validation/dice': 0.6322703504408227}
  0%|                                                                                                                     | 0/64 [00:00<?, ?it/s]
  0%|                                                                                                                    | 0/582 [00:00<?, ?it/s]
  0%|                                                                                                                     | 0/64 [00:00<?, ?it/s]
  0%|                                                                                                                    | 0/582 [00:00<?, ?it/s]
  0%|                                                                                                                     | 0/64 [00:00<?, ?it/s]
  0%|                                                                                                                    | 0/582 [00:00<?, ?it/s]
  0%|                                                                                                                     | 0/64 [00:00<?, ?it/s]
  0%|                                                                                                                    | 0/582 [00:00<?, ?it/s]
  0%|                                                                                                                     | 0/64 [00:00<?, ?it/s]
Epoch [5/100] - Loss: 2.1394991874694824
{'Train/accuracy': 0.3142242431640625, 'Train/iou': 0.1111111111111111, 'Train/dice': 1.6312935884026136}
{'Validation/accuracy': 0.46282958984375, 'Validation/iou': 0.1111111111111111, 'Validation/dice': 0.7191051293696127}
Epoch [6/100] - Loss: 2.1235923767089844
{'Train/accuracy': 0.32098388671875, 'Train/iou': 0.1111111111111111, 'Train/dice': -3.9270871203409623}
{'Validation/accuracy': 0.4553680419921875, 'Validation/iou': 0.1111111111111111, 'Validation/dice': 0.8076773534363089}
Epoch [7/100] - Loss: 2.0873498916625977
{'Train/accuracy': 0.3506317138671875, 'Train/iou': 0.1111111111111111, 'Train/dice': 1.2640906153229647}
{'Validation/accuracy': 0.4530487060546875, 'Validation/iou': 0.1111111111111111, 'Validation/dice': 0.8848246672160179}
Epoch [8/100] - Loss: 2.1027297973632812
{'Train/accuracy': 0.302581787109375, 'Train/iou': 0.1111111111111111, 'Train/dice': 1.0986465914587624}
{'Validation/accuracy': 0.45751953125, 'Validation/iou': 0.1111111111111111, 'Validation/dice': 0.9657548943860932}
Epoch [9/100] - Loss: 2.0560662746429443
{'Train/accuracy': 0.3474273681640625, 'Train/iou': 0.1111111111111111, 'Train/dice': 0.8781709394115482}
{'Validation/accuracy': 0.4542388916015625, 'Validation/iou': 0.1111111111111111, 'Validation/dice': 1.0322670114952213}
  0%|                                                                                                                    | 0/582 [00:00<?, ?it/s]
  0%|                                                                                                                     | 0/64 [00:00<?, ?it/s]
  0%|                                                                                                                    | 0/582 [00:00<?, ?it/s]
  0%|                                                                                                                     | 0/64 [00:00<?, ?it/s]
  0%|                                                                                                                    | 0/582 [00:00<?, ?it/s]
  0%|                                                                                                                     | 0/64 [00:00<?, ?it/s]
  0%|                                                                                                                    | 0/582 [00:00<?, ?it/s]
  0%|                                                                                                                     | 0/64 [00:00<?, ?it/s]
  0%|                                                                                                                    | 0/582 [00:00<?, ?it/s]
  0%|                                                                                                                     | 0/64 [00:00<?, ?it/s]
Epoch [10/100] - Loss: 2.0387964248657227
{'Train/accuracy': 0.3625335693359375, 'Train/iou': 0.1111111111111111, 'Train/dice': 0.856324186435239}
{'Validation/accuracy': 0.4449920654296875, 'Validation/iou': 0.1111111111111111, 'Validation/dice': 1.073082989496833}
Epoch [11/100] - Loss: 2.028773784637451
{'Train/accuracy': 0.4029388427734375, 'Train/iou': 0.1111111111111111, 'Train/dice': 1.0947786439844753}
{'Validation/accuracy': 0.437042236328125, 'Validation/iou': 0.1111111111111111, 'Validation/dice': 1.1076488561783389}
Epoch [12/100] - Loss: 1.9877707958221436
{'Train/accuracy': 0.50274658203125, 'Train/iou': 0.1111111111111111, 'Train/dice': 0.9069307944657421}
{'Validation/accuracy': 0.442962646484375, 'Validation/iou': 0.1111111111111111, 'Validation/dice': 1.1689840051294589}
Epoch [13/100] - Loss: 2.019974946975708
{'Train/accuracy': 0.3710174560546875, 'Train/iou': 0.1111111111111111, 'Train/dice': 0.7890301268370279}
{'Validation/accuracy': 0.4571380615234375, 'Validation/iou': 0.1111111111111111, 'Validation/dice': 1.275418888529592}
Epoch [14/100] - Loss: 1.9807381629943848
{'Train/accuracy': 0.4634246826171875, 'Train/iou': 0.1111111111111111, 'Train/dice': 0.7829944116228691}
{'Validation/accuracy': 0.475341796875, 'Validation/iou': 0.1111111111111111, 'Validation/dice': 1.428963646696332}
  0%|                                                                                                                    | 0/582 [00:00<?, ?it/s]
  0%|                                                                                                                     | 0/64 [00:00<?, ?it/s]
  0%|                                                                                                                    | 0/582 [00:00<?, ?it/s]
  0%|                                                                                                                     | 0/64 [00:00<?, ?it/s]
  0%|                                                                                                                    | 0/582 [00:00<?, ?it/s]
  0%|                                                                                                                     | 0/64 [00:00<?, ?it/s]
  0%|                                                                                                                    | 0/582 [00:00<?, ?it/s]
  0%|                                                                                                                     | 0/64 [00:00<?, ?it/s]
  0%|                                                                                                                    | 0/582 [00:00<?, ?it/s]
  0%|                                                                                                                     | 0/64 [00:00<?, ?it/s]
Epoch [15/100] - Loss: 1.9693689346313477
{'Train/accuracy': 0.43084716796875, 'Train/iou': 0.1111111111111111, 'Train/dice': 0.7079307108941238}
{'Validation/accuracy': 0.477783203125, 'Validation/iou': 0.1111111111111111, 'Validation/dice': 1.459826543302511}
Epoch [16/100] - Loss: 1.9365816116333008
{'Train/accuracy': 0.5180816650390625, 'Train/iou': 0.1111111111111111, 'Train/dice': 0.7577819956428665}
{'Validation/accuracy': 0.4773101806640625, 'Validation/iou': 0.1111111111111111, 'Validation/dice': 1.395399910147467}
Epoch [17/100] - Loss: 1.9650695323944092
{'Train/accuracy': 0.455657958984375, 'Train/iou': 0.1111111111111111, 'Train/dice': 0.6832766253587472}
{'Validation/accuracy': 0.486572265625, 'Validation/iou': 0.1111111111111111, 'Validation/dice': 1.3464143908614907}
Epoch [18/100] - Loss: 1.9627807140350342
{'Train/accuracy': 0.3966064453125, 'Train/iou': 0.1111111111111111, 'Train/dice': 0.6955812337178646}
{'Validation/accuracy': 0.5041046142578125, 'Validation/iou': 0.1111111111111111, 'Validation/dice': 1.3834676041627207}
Epoch [19/100] - Loss: 1.9416322708129883
{'Train/accuracy': 0.431671142578125, 'Train/iou': 0.1111111111111111, 'Train/dice': 0.6630397570593737}
{'Validation/accuracy': 0.499481201171875, 'Validation/iou': 0.1111111111111111, 'Validation/dice': 1.2646831702160486}
  0%|                                                                                                                    | 0/582 [00:00<?, ?it/s]
  0%|                                                                                                                     | 0/64 [00:00<?, ?it/s]
  0%|                                                                                                                    | 0/582 [00:00<?, ?it/s]
  0%|                                                                                                                     | 0/64 [00:00<?, ?it/s]
  0%|                                                                                                                    | 0/582 [00:00<?, ?it/s]
  0%|                                                                                                                     | 0/64 [00:00<?, ?it/s]Exception ignored in: <function _releaseLock at 0x7f0ca1961d40>
Traceback (most recent call last):
  File "/home/macula/SMATousi/.conda/envs/mac-deep/lib/python3.7/logging/__init__.py", line 221, in _releaseLock
    def _releaseLock():
KeyboardInterrupt
  0%|                                                                                                                     | 0/64 [00:00<?, ?it/s]
  0%|                                                                                                                    | 0/582 [00:00<?, ?it/s]
  0%|                                                                                                                     | 0/64 [00:00<?, ?it/s]
  0%|                                                                                                                    | 0/582 [00:00<?, ?it/s]
  0%|                                                                                                                     | 0/64 [00:00<?, ?it/s]
Epoch [20/100] - Loss: 1.9623095989227295
{'Train/accuracy': 0.39593505859375, 'Train/iou': 0.1111111111111111, 'Train/dice': 0.6210504476214546}
{'Validation/accuracy': 0.5095062255859375, 'Validation/iou': 0.1111111111111111, 'Validation/dice': 1.23097717179149}
Epoch [21/100] - Loss: 1.9124791622161865
{'Train/accuracy': 0.4827728271484375, 'Train/iou': 0.1111111111111111, 'Train/dice': 0.6539080807644158}
{'Validation/accuracy': 0.5230560302734375, 'Validation/iou': 0.1111111111111111, 'Validation/dice': 1.0754307514909425}
Epoch [22/100] - Loss: 1.9076409339904785
{'Train/accuracy': 0.448455810546875, 'Train/iou': 0.1111111111111111, 'Train/dice': 0.6414773004444884}
{'Validation/accuracy': 0.5565032958984375, 'Validation/iou': 0.1111111111111111, 'Validation/dice': 0.9566555116244645}
Epoch [23/100] - Loss: 1.9244005680084229
{'Train/accuracy': 0.4633026123046875, 'Train/iou': 0.1111111111111111, 'Train/dice': 0.6219880154911329}
{'Validation/accuracy': 0.5590667724609375, 'Validation/iou': 0.1111111111111111, 'Validation/dice': 0.9409452891201764}
  0%|                                                                                                                    | 0/582 [00:00<?, ?it/s]
  0%|                                                                                                                     | 0/64 [00:00<?, ?it/s]
  0%|                                                                                                                    | 0/582 [00:00<?, ?it/s]
  0%|                                                                                                                     | 0/64 [00:00<?, ?it/s]
  0%|                                                                                                                    | 0/582 [00:00<?, ?it/s]
Traceback (most recent call last):
  File "train.py", line 143, in <module>
    acc, iou, dice = calculate_metrics(outputs, so_image)
  File "/home/macula/SMATousi/Gullies/ground_truth/google_api/training_process/DEM2SO/code/dem2so/utils.py", line 13, in calculate_metrics
    predicted = predicted.cpu().detach().numpy()
KeyboardInterrupt